# TCP/IP

TCP, IP ëŠ” ëª¨ë‘ í”„ë¡œí† ì½œì˜ ì¼ì¢…ì´ë‹¤. 

> ğŸ’¡**í”„ë¡œí† ì½œì€ ë¬´ì—‡ì¸ê°€?** 
> 
>  í”„ë¡œí† ì½œì€ ì»´í“¨í„° ë‚´ë¶€ì—ì„œ, ë˜ëŠ” ì»´í“¨í„° ì‚¬ì´ì—ì„œ ë°ì´í„°ì˜ êµí™˜ ë°©ì‹ì„ ì •ì˜í•˜ëŠ” ê·œì¹™ ì²´ê³„ì…ë‹ˆë‹¤. ê¸°ê¸° ê°„ í†µì‹ ì€ êµí™˜ë˜ëŠ” ë°ì´í„°ì˜ í˜•ì‹ì— ëŒ€í•´ ìƒí˜¸ í•©ì˜ë¥¼ ìš”êµ¬í•©ë‹ˆë‹¤. ì´ëŸ° í˜•ì‹ì„ ì •ì˜í•˜ëŠ” ê·œì¹™ì˜ ì§‘í•©ì„ í”„ë¡œí† ì½œì´ë¼ê³  í•©ë‹ˆë‹¤.
> 
> ì¶œì²˜ : MDN

## TCP

OSI 7 ê³„ì¸µ ì¤‘ ì „ì†¡ ê³„ì¸µì—ì„œ í™œìš©ë˜ëŠ” í”„ë¡œí† ì½œ ì¤‘ í•˜ë‚˜ì´ë‹¤. 3ê³„ì¸µì˜ IP í”„ë¡œí† ì½œê³¼ í•¨ê»˜ ì“°ì´ëŠ” ê²½ìš°ê°€ ë§ì•„ TCP/IP ë¡œ í‘œí˜„í•˜ê¸°ë„ í•œë‹¤. 

### TCP íŠ¹ì§•

- ì‹ ë¢°ì„±: íŒ¨í‚· ì†ì‹¤Â·ì˜¤ë¥˜ë¥¼ ê°ì§€í•˜ê³  ì¬ì „ì†¡ì„ í†µí•´ ë³µêµ¬í•©ë‹ˆë‹¤.
- ìˆœì„œ ë³´ì¥: ë°”ì´íŠ¸ ìŠ¤íŠ¸ë¦¼ ë‹¨ìœ„ë¡œ ìˆœì„œë¥¼ ìœ ì§€í•˜ì—¬ ì „ì†¡í•©ë‹ˆë‹¤.
- ì—°ê²° ì§€í–¥ì : 3-way handshakeë¡œ ì—°ê²°ì„ ì„¤ì •í•˜ê³ , FIN êµí™˜ìœ¼ë¡œ ì¢…ë£Œí•©ë‹ˆë‹¤.
- ì–‘ë°©í–¥ í†µì‹ : í•œ ì—°ê²°ì—ì„œ ì–‘ë°©í–¥ ë°ì´í„° íë¦„ì„ ì§€ì›í•©ë‹ˆë‹¤.
- í¬íŠ¸ ê¸°ë°˜ ë‹¤ì¤‘í™”: IP ì£¼ì†Œ + í¬íŠ¸ ë²ˆí˜¸ ì¡°í•©ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹ë³„í•©ë‹ˆë‹¤.

### TCP ì„¸ê·¸ë¨¼íŠ¸ 

![tcp_segment](../images/tcp_segment.png)

- ì‹œí€€ìŠ¤ ë²ˆí˜¸(Sequence Number): ë°ì´í„°ì˜ ìˆœì„œë¥¼ ì¶”ì 
- ACK ë²ˆí˜¸(Ack Number): ë‹¤ìŒìœ¼ë¡œ ê¸°ëŒ€í•˜ëŠ” ë°”ì´íŠ¸ ë²ˆí˜¸
- í”Œë˜ê·¸(Flags): SYN, ACK, FIN, RST, PSH, URG, ECE, CWR
- ìœˆë„ìš°(Window): ìˆ˜ì‹  ì¸¡ì´ í—ˆìš© ê°€ëŠ¥í•œ ë°ì´í„° í¬ê¸°
- ì²´í¬ì„¬(Checksum): í—¤ë”Â·ë°ì´í„° ì˜¤ë¥˜ ê²€ì¶œìš© (í•­ìƒ í•„ìˆ˜)

### 3-way Handshake

3-way HandshakeëŠ” ì†¡ì‹ ì¸¡ê³¼ ìˆ˜ì‹ ì¸¡ ëª¨ë‘ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì„ ì¤€ë¹„ê°€ ë˜ì–´ìˆìŒì„ í™•ì¸í•˜ê³ , íŒ¨í‚· ìˆœì„œì™€ ì‹ ë¢°ì„±ì„ ë³´ì¥í•  ìˆ˜ ìˆëŠ” ì´ˆê¸° ìƒíƒœë¥¼ ë§ì¶”ëŠ” ê³¼ì •ì´ë‹¤. 

![tcp_handshake](../images/tcp-handshake.png)

### 4-way Handshake

4-way HandshakeëŠ” TCP ì—°ê²°ì„ ì¢…ë£Œí•˜ëŠ” ê³¼ì •ì´ë‹¤. ì–‘ì¸¡ì´ FIN í”Œë˜ê·¸ë¥¼ êµí™˜í•˜ì—¬ ì—°ê²° ì¢…ë£Œë¥¼ í™•ì¸í•œë‹¤.

![tcp_4way_handshake](../images/tcp_4way_handshake.png)

> ğŸ’¡**TCPëŠ” ì™œ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ”ê°€?**
> 
> - Checksum ì„ í†µí•´ì„œ ì†ìƒì„ ë°©ì§€
> - íë¦„ ì œì–´(ìˆ˜ì‹  ìœˆë„ìš°, ZWP, ìœˆë„ìš° ìŠ¤ì¼€ì¼ë§)ë¡œ ìˆ˜ì‹  ë²„í¼ë¥¼ ë³´í˜¸
> - í˜¼ì¡ ì œì–´(RTO ì¶”ì •, Selective ACK)ë¥¼ í†µí•´ ë„¤íŠ¸ì›Œí¬ í˜¼ì¡ì—ë„ ëŒ€ì‘
> - ì´ˆê¸° ì‹œí€¸ìŠ¤ ë²ˆí˜¸ë¥´ ì–‘ì¸¡ì´ êµí™˜í•´ ì˜ˆì „ ì—°ê²°ì˜ ì„¸ê·¸ë¨¼íŠ¸ê°€ í˜„ì¬ ì—°ê²°ì„ ì˜¤ì—¼ì‹œí‚¤ì§€ ì•Šë„ë¡ í•¨
> - ì—°ê²° ì¢…ë£Œ í›„ì—ë„ ì ì‹œ ëŒ€ê¸°í•˜ì—¬ ì§€ì—° ë„ì°© ì„¸ê·¸ë¨¼íŠ¸ê°€ ë‹¤ë¥¸ ì—°ê²°ì— ì„ì´ì§€ ì•Šê²Œ ê²©ë¦¬

**TCP í˜¼ì¡ ì œì–´ ì•Œê³ ë¦¬ì¦˜ > AIMD(Additive Increase Multiplicative Decrease)**
![tcp_congestion_control_algorithm](../images/TCP_AIMD.png)

### TCP vs UDP

> ğŸ’¡**ìµœê·¼ UDP ê°€ ì£¼ëª©ë°›ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€?**
> 
> í†µì‹  ê¸°ìˆ ì˜ ë°œë‹¬(5G, Wi-Fi) -> í° ë°ì´í„° ì „ì†¡ ê°€ëŠ¥ -> UDP í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì „ì†¡
> ëŒ€í‘œì ìœ¼ë¡œ Youtube, Netflix ì™€ ê°™ì€ ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ê°€ UDP ê¸°ë°˜ìœ¼ë¡œ ë™ì‘
> 
> HTTP 2.0 ì—ì„œëŠ” TCP ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— HOLB(Head of Line Blocking) ë¬¸ì œê°€ ë°œìƒ
> êµ¬ê¸€ì´ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ UDP ê¸°ë°˜ì˜ QUIC í”„ë¡œí† ì½œì„ ê°œë°œ
> HTTP 2.0 ì—ì„œ ì¡´ì¬í•˜ë˜ ë¬¸ì œì ì„ ëŒ€ë¶€ë¶„ í•´ê²°, RTT(Round Trip Time) ì œë¡œ ìˆ˜ì¤€ìœ¼ë¡œ ì¤„ì´ê³ , íŒ¨í‚· ì†ì‹¤ì— ëŒ€í•œ ë¹ ë¥¸ ëŒ€ì‘, ì‚¬ìš©ì IP ê°€ ë°”ë€Œì–´ë„ ì—°ê²°ì´ ìœ ì§€

![udp_header](../images/udp_header.png)

| í•­ëª©        | TCP                      | UDP                |
| --------- | ------------------------ | ------------------ |
| **ì—°ê²° ì—¬ë¶€** | ì—°ê²°í˜• (3-way handshake í•„ìš”) | ë¹„ì—°ê²°í˜• (ë°”ë¡œ ì „ì†¡)       |
| **ì‹ ë¢°ì„±**   | íŒ¨í‚· ìˆœì„œÂ·ì¬ì „ì†¡ ë³´ì¥             | ë³´ì¥í•˜ì§€ ì•ŠìŒ            |
| **ì†ë„**    | ëŠë¦¼ (ê²€ì¦ ì ˆì°¨ ë§ìŒ)            | ë¹ ë¦„ (ê²€ì¦ ì ˆì°¨ ì—†ìŒ)      |
| **ìš©ë„**    | íŒŒì¼ ì „ì†¡, ì´ë©”ì¼, ì›¹ ë“±          | ìŠ¤íŠ¸ë¦¬ë°, ê²Œì„, ì‹¤ì‹œê°„ í†µì‹  ë“± |
| **í—¤ë” í¬ê¸°** | 20ë°”ì´íŠ¸ ì´ìƒ                 | 8ë°”ì´íŠ¸               |



### References

- https://datatracker.ietf.org/doc/html/rfc9293
- https://inpa.tistory.com/entry/WEB-%F0%9F%8C%90-TCP-IP-%EC%A0%95%EB%A6%AC-%F0%9F%91%AB%F0%9F%8F%BD-TCP-IP-4%EA%B3%84%EC%B8%B5
- https://docs.tosspayments.com/resources/glossary/tcp#tcp-%ED%86%B5%EC%8B%A0-%EA%B3%BC%EC%A0%95
- https://code-lab1.tistory.com/30
- https://inpa.tistory.com/entry/NW-%F0%9F%8C%90-%EC%95%84%EC%A7%81%EB%8F%84-%EB%AA%A8%ED%98%B8%ED%95%9C-TCP-UDP-%EA%B0%9C%EB%85%90-%E2%9D%93-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EC%9E%90